select (case when D.SalesOrderStatus = 100 then 'Onay Bekliyor' when D.SalesOrderStatus = 101 then 'Eco1 Bekliyor' when D.SalesOrderStatus = 102 then 'Eco1 Laminasyon Bekliyor' when D.SalesOrderStatus = 103 then 'Eco2 Bekliyor' when D.SalesOrderStatus = 104 then 'Eco3 Bekliyor' when D.SalesOrderStatus = 105 then 'Eco4 Bekliyor' when D.SalesOrderStatus = 106 then 'Eco4 Dilme Bekliyor' when D.SalesOrderStatus = 107 then 'Eco5 Cpp Bekliyor' when D.SalesOrderStatus = 108 then 'Eco5 Stretch Bekliyor' when D.SalesOrderStatus = 109 then 'Eco5 Aktarma Bekliyor' when D.SalesOrderStatus = 110 then 'Eco5 Dilme Bekliyor' when D.SalesOrderStatus = 111 then 'Eco5 Rejenere Bekliyor' when D.SalesOrderStatus = 112 then 'Eco6 Bekliyor' when D.SalesOrderStatus = 113 then 'Eco6 Kesim Bekliyor' when D.SalesOrderStatus = 114 then 'Eco6 Laminasyon Bekliyor' when D.SalesOrderStatus = 120 then 'Üretim Bekliyor' when D.SalesOrderStatus = 130 then 'Sevkiyat Bekliyor' when D.SalesOrderStatus = 131 then 'Yükleme Bekliyor' when D.SalesOrderStatus = 200 then 'Sevk Edildi' when D.SalesOrderStatus = 900 then 'Ýptal Edildi' else '' end) as [Durumu], C.Name as [Malý Teslim Alan], SC.Name as [Sipariþi Veren], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariþ No], P.Code as [Malzeme Kodu], P.Name as [Ýþin Adý], O.OrderDate as [Sipariþ Tarihi], D.LineDeliveryDate as [Termin Tarihi], D.Quantity as [Sipariþ SÖB Miktar], D.ShippedQuantity as [Sevk Edilen SÖB Miktar], (select isnull(SUM(Quantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null) and SalesOrderDetail = D.Oid) as [Depo SÖB Miktar], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1)) as [Depo TÖB Miktar], U.Code as [SÖB Birim], D.cQuantity as [Sipariþ TÖB Miktar], D.ShippedcQuantity as [Sevk Edilen TÖB Miktar], PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satýþ Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskýlý' else 'Baskýsýz' end) as [Baský Durumu], (case when D.SalesOrderWorkStatus = 0 then 'Yeni' when D.SalesOrderWorkStatus = 1 then 'Tekrar' else 'Revizyon' end) as [Ýþ Durumu], SO.Name as [Satýþ Ofisi], SG.Name as [Satýþ Grubu], R.Name as [Rota], CT.Name as [Ýl], D.PetkimPrice as [Petkim Fiyatý], D.GeneralCost as [Genel Gider], D.PetkimUnitPrice as [Petkim Birim Fiyat], (case when O.SalesOrderType = 0 then 'Standart Sipariþi' when O.SalesOrderType = 1 then 'Planlama Sipariþi' when O.SalesOrderType = 2 then 'Ýhracat Sipariþi' when O.SalesOrderType = 3 then 'Ýhraç Kayýtlý Sipariþ' when O.SalesOrderType = 4 then 'A3 Sipariþi' when O.SalesOrderType = 5 then 'Rejenere Sipariþi' when O.SalesOrderType = 6 then 'Ýade Sipariþi' when O.SalesOrderType = 7 then 'Arge Sipariþi' else '' end) as [Sipariþ Türü], PZ.Name as [Petkim Zammý], (case when O.TransportType = 0 then 'Nakliye Bize' else 'Nakliye Karþýya' end) as [Nakliye Türü], DC.Name as [Daðýtým Kanalý], PM.Name as [Ödeme Methodu], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baský')) as [Baský Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [Konfeksiyon Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [Dilme Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [Laminasyon Depo] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join City CT on CT.Oid = C.City inner join [Route] R on R.Oid = CT.[Route] inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup inner join Unit U on U.Oid = D.Unit inner join Unit CU on CU.Oid = D.cUnit inner join SalesOffice SO on SO.Oid = O.SalesOffice inner join SalesGroup SG on SG.Oid = O.SalesGroup inner join ContactGroup2 PZ on PZ.Oid = O.ContactGroup2 inner join DistributionChannel DC on DC.Oid = O.DistributionChannel inner join PaymentMethod PM on PM.Oid = O.PaymentMethod where D.GCRecord is null and cast(O.OrderDate as date) between '{0}' and '{1}'