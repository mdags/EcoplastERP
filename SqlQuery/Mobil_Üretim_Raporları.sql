select S.Code as [StationCode], isnull(sum(P.GrossQuantity), 0) as [ProductionQuantity], (select isnull(SUM(W.GrossQuantity), 0) from Wastage W inner join Machine M1 on M1.Oid = W.Machine inner join Station S1 on S1.Oid = M1.Station where W.GCRecord is null and S1.Code = S.Code and WastageDate between '2017-02-01' and '2017-02-28') as [WastageQuantity] from Production P inner join Machine M on M.Oid = P.Machine inner join Station S on S.Oid = M.Station where P.GCRecord is null and P.ProductionDate between '2017-02-01' and '2017-02-28' group by S.Code order by S.Code

select M.Code as [MachineCode], sum(P.GrossQuantity) as [ProductionQuantity], (select isnull(SUM(W.GrossQuantity), 0) from Wastage W inner join Machine M1 on M1.Oid = W.Machine where W.GCRecord is null and M1.Code = M.Code and WastageDate between '2017-02-01' and '2017-02-28') as [WastageQuantity] from Production P inner join Machine M on M.Oid = P.Machine inner join Station S on S.Oid = M.Station where P.GCRecord is null and S.Code = 'Eco2' and P.ProductionDate between '2017-02-01' and '2017-02-28' group by M.Code order by M.Code

select WS.Name as [Shift], E.NameSurname as [Operator], sum(P.GrossQuantity) as [ProductionQuantity]
, (select isnull(SUM(W.GrossQuantity), 0) from Wastage W inner join Machine M1 on M1.Oid = W.Machine inner join ShiftStart SS1 on SS1.Oid = W.[Shift] left outer join Employee E1 on E1.Oid = W.Employee inner join WorkShift WS1 on WS1.Oid = SS1.WorkShift where W.GCRecord is null and M1.Code = M.Code and WS1.Oid = WS.Oid and E1.Oid = E.Oid and WastageDate between '2017-02-01' and '2017-02-28') as [WastageQuantity] 
from Production P inner join Machine M on M.Oid = P.Machine inner join Station S on S.Oid = M.Station inner join ShiftStart SS on SS.Oid = P.[Shift] left outer join Employee E on E.Oid = P.Employee inner join WorkShift WS on WS.Oid = SS.WorkShift where P.GCRecord is null and M.Code = 'BW11' and P.ProductionDate between '2017-02-01' and '2017-02-28' group by M.Code, WS.Oid, WS.Name, E.Oid, E.NameSurname order by WS.Name