select D.CuttingMachineGroup, isnull(C.Name, 'Z-GRUBU OLMAYANLAR') as [Kesim Makine Grubu]
, SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) as [Bekleyen TÖB Miktar], (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) as [Sevk Depo TÖB Miktar]
, (case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) else 0 end) as [Üretilecek TÖB Miktar], isnull(C.Capacity, 0) as [Kapasite (gün)], (case when C.Capacity > 0 then (((case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) else 0 end)) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Toplam Dolu Gün], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) as [Geçmiþ Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Geçmiþ Gün Doluluk], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) as [Bu Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bu Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [Bir Sonraki Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bir Sonraki Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [Ýleri Termin Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Ýleri Termin Doluluk], sum(D.cQuantity) as [Sipariþ TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) as [Sevk Edilen TÖB Miktar]
, (case when (select isnull(sum(Quantity), 0) from PrintingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and PrintingWOrkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) > 0 then (select isnull(sum(Quantity), 0) from PrintingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and PrintingWOrkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) else 0 end) as [Baský Üretilecek]
, (case when (select isnull(sum(Quantity), 0) from CuttingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and CuttingWorkOrder in (select Oid from CuttingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) > 0 then (select isnull(sum(Quantity), 0) from CuttingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and CuttingWorkOrder in (select Oid from CuttingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) else 0 end) as [Kesim Üretilecek]
, (case when (select isnull(sum(Quantity), 0) from SlicingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) > 0 then (select isnull(sum(Quantity), 0) from SlicingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) else 0 end) as [Dilme Üretilecek]
, (case when (select isnull(sum(Quantity), 0) from LaminationWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) > 0 then (select isnull(sum(Quantity), 0) from LaminationWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) - (select isnull(sum(NetQuantity), 0) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and WorkOrderStatus < 110 and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) else 0 end) as [Laminasyon Üretilecek] 
from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder left outer join CuttingMachineGroup C on C.Oid = D.CuttingMachineGroup inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') group by D.CuttingMachineGroup, C.Name, C.Capacity order by [Kesim Makine Grubu]