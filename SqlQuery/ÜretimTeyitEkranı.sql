select P.WorkOrderNumber as [Üretim Sipariþi Numarasý], P.Barcode as Barkod, M.Name as Makine, l.PaletteNumber as [Palet Numarasý]
, (case when FilmingWorkOrder is not null then (select Width from FilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastFilmingWorkOrder is not null then (select Width from CastFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastTransferingWorkOrder is not null then (select Width from CastTransferingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when BalloonFilmingWorkOrder is not null then (select Width from BalloonFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when PrintingWorkOrder is not null then (select Width from PrintingWorkOrder where Oid = P.PrintingWorkOrder) when LaminationWorkOrder is not null then (select Width from LaminationWorkOrder where Oid = P.LaminationWorkOrder) when SlicingWorkOrder is not null then (select Width from SlicingWorkOrder where Oid = P.SlicingWorkOrder) when CastSlicingWorkOrder is not null then (select Width from CastSlicingWorkOrder where Oid = P.CastSlicingWorkOrder) when CuttingWorkOrder is not null then (select Width from CuttingWorkOrder where Oid = P.CuttingWorkOrder) when FoldingWorkOrder is not null then (select Width from FoldingWorkOrder where Oid = P.FoldingWorkOrder) when BalloonCuttingWorkOrder is not null then (select Width from BalloonCuttingWorkOrder where Oid = P.BalloonCuttingWorkOrder) when Eco6WorkOrder is not null then '0' when Eco6CuttingWorkOrder is not null then (select Width from Eco6CuttingWorkOrder where Oid = P.Eco6CuttingWorkOrder) when Eco6LaminationWorkOrder is not null then (select Width from Eco6LaminationWorkOrder where Oid = P.Eco6LaminationWorkOrder) else '0' end) as En
, (case when FilmingWorkOrder is not null then (select Height from FilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastFilmingWorkOrder is not null then (select Height from CastFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastTransferingWorkOrder is not null then (select Height from CastTransferingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when BalloonFilmingWorkOrder is not null then (select Height from BalloonFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when PrintingWorkOrder is not null then (select Height from PrintingWorkOrder where Oid = P.PrintingWorkOrder) when LaminationWorkOrder is not null then (select Width from LaminationWorkOrder where Oid = P.LaminationWorkOrder) when SlicingWorkOrder is not null then (select Width from SlicingWorkOrder where Oid = P.SlicingWorkOrder) when CastSlicingWorkOrder is not null then (select Height from CastSlicingWorkOrder where Oid = P.CastSlicingWorkOrder) when CuttingWorkOrder is not null then (select Width from CuttingWorkOrder where Oid = P.CuttingWorkOrder) when FoldingWorkOrder is not null then (select Height from FoldingWorkOrder where Oid = P.FoldingWorkOrder) when BalloonCuttingWorkOrder is not null then (select Height from BalloonCuttingWorkOrder where Oid = P.BalloonCuttingWorkOrder) when Eco6WorkOrder is not null then '0' when Eco6CuttingWorkOrder is not null then (select Height from Eco6CuttingWorkOrder where Oid = P.Eco6CuttingWorkOrder) when Eco6LaminationWorkOrder is not null then (select Height from Eco6LaminationWorkOrder where Oid = P.Eco6LaminationWorkOrder) else '0' end) as Boy
, (case when FilmingWorkOrder is not null then (select [Length] from FilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastFilmingWorkOrder is not null then (select [Length] from CastFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when CastTransferingWorkOrder is not null then (select [Length] from CastTransferingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when BalloonFilmingWorkOrder is not null then (select [Length] from BalloonFilmingWorkOrder where WorkOrderNumber = P.WorkOrderNumber) when PrintingWorkOrder is not null then (select [Length] from PrintingWorkOrder where Oid = P.PrintingWorkOrder) when LaminationWorkOrder is not null then (select [Length] from LaminationWorkOrder where Oid = P.LaminationWorkOrder) when SlicingWorkOrder is not null then (select [Length] from SlicingWorkOrder where Oid = P.SlicingWorkOrder) when CastSlicingWorkOrder is not null then (select [Length] from CastSlicingWorkOrder where Oid = P.CastSlicingWorkOrder) when CuttingWorkOrder is not null then (select [Length] from CuttingWorkOrder where Oid = P.CuttingWorkOrder) when FoldingWorkOrder is not null then (select [Length] from FoldingWorkOrder where Oid = P.FoldingWorkOrder) when BalloonCuttingWorkOrder is not null then (select [Length] from BalloonCuttingWorkOrder where Oid = P.BalloonCuttingWorkOrder) when Eco6WorkOrder is not null then '0' when Eco6CuttingWorkOrder is not null then (select [Length] from Eco6CuttingWorkOrder where Oid = P.Eco6CuttingWorkOrder) when Eco6LaminationWorkOrder is not null then (select [Length] from Eco6LaminationWorkOrder where Oid = P.Eco6LaminationWorkOrder) else '0' end) as Uzunluk
, WS.Name as Vardiya, E.NameSurname as [Operatör], U.Code as Birimi, P.GrossQuantity as [Brüt Miktar], P.NetQuantity as [Net Miktar], P.ProductionDate as [Üretim Tarihi] from Production P inner join Machine M on M.Oid = P.Machine inner join ShiftStart S on S.Oid = P.[Shift] left outer join Employee E on E.Oid = P.Employee inner join Unit U on U.Oid = P.Unit left outer join ProductionPalette l on l.Oid = P.ProductionPalette inner join WorkShift WS on WS.Oid = S.WorkShift where P.GCRecord is null And P.WorkOrderNumber = 'C17217034' order by P.Barcode