select C.Oid, C.Code, C.Name from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact where D.GCRecord is null and D.SalesOrderStatus < 200 group by C.Oid, C.Code, C.Name order by C.Name

select O.ContactOrderNumber, O.ContactOrderDate, (case when D.SalesOrderStatus = 100 then 'Onay Bekliyor' when D.SalesOrderStatus = 101 then 'Eco1 Bekliyor' when D.SalesOrderStatus = 102 then 'Eco1 Laminasyon Bekliyor' when D.SalesOrderStatus = 103 then 'Eco2 Bekliyor' when D.SalesOrderStatus = 104 then 'Eco3 Bekliyor' when D.SalesOrderStatus = 105 then 'Eco4 Bekliyor' when D.SalesOrderStatus = 106 then 'Eco4 Dilme Bekliyor' when D.SalesOrderStatus = 107 then 'Eco5 Cpp Bekliyor' when D.SalesOrderStatus = 108 then 'Eco5 Stretch Bekliyor' when D.SalesOrderStatus = 109 then 'Eco5 Aktarma Bekliyor' when D.SalesOrderStatus = 110 then 'Eco5 Dilme Bekliyor' when D.SalesOrderStatus = 111 then 'Eco5 Rejenere Bekliyor' when D.SalesOrderStatus = 112 then 'Eco6 Bekliyor' when D.SalesOrderStatus = 113 then 'Eco6 Kesim Bekliyor' when D.SalesOrderStatus = 114 then 'Eco6 Laminasyon Bekliyor' when D.SalesOrderStatus = 120 then 'Üretim Bekliyor' when D.SalesOrderStatus = 130 then 'Sevkiyat Bekliyor' when D.SalesOrderStatus = 131 then 'Yükleme Bekliyor' when D.SalesOrderStatus = 200 then 'Sevk Edildi' when D.SalesOrderStatus = 900 then 'Ýptal Edildi' else '' end) as [SalesOrderStatus], C.Name as [Contact], SC.Name as [ShippingContact], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [OrderNumber], P.Name as [WorkName], O.OrderDate, D.LineDeliveryDate, D.Quantity as [OrderedQuantity], D.ShippedQuantity as [ShippedQuantity], (select isnull(SUM(Quantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null) and SalesOrderDetail = D.Oid) as [StoreQuantity], U.Code as [Unit], D.cQuantity as [OrderedcQuantity], D.ShippedcQuantity as [ShippedcQuantity], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1)) as [StorecQuantity], (case when D.SalesOrderWorkStatus = 0 then 'Yeni' when D.SalesOrderWorkStatus = 1 then 'Tekrar' else 'Revizyon' end) as [WorkStatus], CT.Name as [City], D.PetkimPrice, D.GeneralCost, D.PetkimUnitPrice, PZ.Name as [PetkimExtra], (case when O.TransportType = 0 then 'Nakliye Bize' else 'Nakliye Karþýya' end) as [TransportType], PM.Name as [PaymentMethod], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baský')) as [PrintingStore], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [CuttingStore], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [SlicingStore], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [LaminationStore] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join City CT on CT.Oid = C.City inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join Unit U on U.Oid = D.Unit inner join Unit CU on CU.Oid = D.cUnit inner join ContactGroup2 PZ on PZ.Oid = O.ContactGroup2 inner join PaymentMethod PM on PM.Oid = O.PaymentMethod where D.GCRecord is null and D.SalesOrderStatus < 200 and C.Oid = 'FBA97CA9-2D33-4D53-A784-57F46FF5BE63'