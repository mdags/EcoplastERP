select C.Oid, C.Name, (select isnull(SUM(D1.Total + D1.Tax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'TL') and O1.Contact = C.Oid) as [TLTotal], (select isnull(SUM(D1.CurrencyTotal + D1.CurrencyTax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'USD') and O1.Contact = C.Oid) as [USDTotal], (select isnull(SUM(D1.CurrencyTotal + D1.CurrencyTax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'EUR') and O1.Contact = C.Oid) as [EURTotal] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact where D.GCRecord is null and D.SalesOrderStatus < 900 and C.Code is not null and C.Name not like 'ECO%' group by C.Oid, C.Name order by C.Name

select PT.Name as [GroupName], PK.Name, (select isnull(SUM(D1.Total + D1.Tax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'TL') and O1.Contact = O.Contact and P1.ProductKind = PK.Oid) as [TLTotal], (select isnull(SUM(D1.Total + D1.Tax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'USD') and O1.Contact = O.Contact and P1.ProductKind = PK.Oid) as [USDTotal], (select isnull(SUM(D1.Total + D1.Tax), 0) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product where D1.GCRecord is null and D1.SalesOrderStatus < 900 and D1.Currency = (select Oid from Currency where GCRecord is null and Code = 'EUR') and O1.Contact = O.Contact and P1.ProductKind = PK.Oid) as [EURTotal] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Product P on P.Oid = D.Product inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind where D.GCRecord is null and D.SalesOrderStatus < 900 and C.Oid = 'F4A30D78-265A-4FE6-B6F7-2D4E51705BD3' group by O.Contact, PT.Name, PK.Oid, PK.Name order by PT.Name, PK.Name