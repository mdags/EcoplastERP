select (case when D.SalesOrderStatus = 0 then 'Planlama Onayý Bekliyor' when D.SalesOrderStatus = 100 then 'Onay Bekliyor' when D.SalesOrderStatus = 101 then 'Eco1 Bekliyor' when D.SalesOrderStatus = 102 then 'Eco1 Laminasyon Bekliyor' when D.SalesOrderStatus = 103 then 'Eco2 Bekliyor' when D.SalesOrderStatus = 104 then 'Eco3 Bekliyor' when D.SalesOrderStatus = 105 then 'Eco4 Bekliyor' when D.SalesOrderStatus = 106 then 'Eco4 Dilme Bekliyor' when D.SalesOrderStatus = 107 then 'Eco5 Cpp Bekliyor' when D.SalesOrderStatus = 108 then 'Eco5 Stretch Bekliyor' when D.SalesOrderStatus = 109 then 'Eco5 Aktarma Bekliyor' when D.SalesOrderStatus = 110 then 'Eco5 Dilme Bekliyor' when D.SalesOrderStatus = 111 then 'Eco5 Rejenere Bekliyor' when D.SalesOrderStatus = 112 then 'Eco6 Bekliyor' when D.SalesOrderStatus = 113 then 'Eco6 Kesim Bekliyor' when D.SalesOrderStatus = 114 then 'Eco6 Laminasyon Bekliyor' when D.SalesOrderStatus = 120 then 'Üretim Bekliyor' when D.SalesOrderStatus = 130 then 'Sevkiyat Bekliyor' when D.SalesOrderStatus = 131 then 'Yükleme Bekliyor' when D.SalesOrderStatus = 200 then 'Sevk Edildi' when D.SalesOrderStatus = 900 then 'Ýptal Edildi' else '' end) as [Durumu], C.Name as [Sipariþi Veren], SC.Name as [Malý Teslim Alan], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariþ No], O.OrderDate as [Sipariþ Tarihi], D.LineDeliveryDate as [Termin Tarihi], P.Code as [Malzeme Kodu], P.Name as [Ýþin Adý], PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satýþ Ürün Grubu], P.Thickness as [Kalýnlýk], D.Quantity as [Sipariþ SÖB Miktar], (select isnull(sum(Quantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen SÖB Miktar], (select isnull(SUM(Quantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null) and SalesOrderDetail = D.Oid) as [Depo SÖB Miktar], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1)) as [Depo TÖB Miktar], U.Code as [SÖB Birim], D.cQuantity as [Sipariþ TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar], D.CurrencyPrice as [Döviz Fiyatý], CR.Code as [Döviz Tipi], D.ExchangeRate as [Kur], D.Parity as [Parite], D.Price as [Fiyatý], D.PetkimPrice as [Petkim Fiyatý], D.GeneralCost as [Genel Gider], D.PetkimUnitPrice as [Petkim Birim Fiyat], D.PlateCost as [Kliþe Bedeli], P.PieceWeight as [Gr/Adet], MT.Name as [Malzeme Türü], MC.Name as [Malzeme Rengi], R1.Code as [Film Kodu1], P.FilmCode1Thickness as [Film Kod1 Kalýnlýðý], R2.Code as [Film Kodu2], P.FilmCode2Thickness as [Film Kod2 Kalýnlýðý], (case when P.PrintStatus = 0 then 'Baskýlý' else 'Baskýsýz' end) as [Baský Durumu], (case when D.SalesOrderWorkStatus = 0 then 'Yeni' when D.SalesOrderWorkStatus = 1 then 'Tekrar' else 'Revizyon' end) as [Ýþ Durumu], SO.Name as [Satýþ Ofisi], SG.Name as [Satýþ Grubu], R.Name as [Rota], CT.Name as [Ýl], (case when O.SalesOrderType = 0 then 'Standart Sipariþi' when O.SalesOrderType = 1 then 'Planlama Sipariþi' when O.SalesOrderType = 2 then 'Ýhracat Sipariþi' when O.SalesOrderType = 3 then 'Ýhraç Kayýtlý Sipariþ' when O.SalesOrderType = 4 then 'A3 Sipariþi' when O.SalesOrderType = 5 then 'Rejenere Sipariþi' when O.SalesOrderType = 6 then 'Ýade Sipariþi' when O.SalesOrderType = 7 then 'Arge Sipariþi' else '' end) as [Sipariþ Türü], PZ.Name as [Petkim Zammý], (case when O.TransportType = 0 then 'Nakliye Bize' else 'Nakliye Karþýya' end) as [Nakliye Türü], DC.Name as [Daðýtým Kanalý], PM.Name as [Ödeme Methodu], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baský')) as [Baský Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [Konfeksiyon Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [Dilme Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail = D.Oid and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [Laminasyon Depo] 

, isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco1 Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco1 Laminasyon Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco2 Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and RegeneratedWorkOrder in (select Oid from RegeneratedWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from RegeneratedWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and RegeneratedWorkOrder in (select Oid from RegeneratedWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from RegeneratedWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco3 Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CuttingWorkOrder in (select Oid from CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CuttingWorkOrder in (select Oid from CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco4 Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco4 Dilme Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastTransferingWorkOrder in (select Oid from CastTransferingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastTransferingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastTransferingWorkOrder in (select Oid from CastTransferingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastTransferingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco5 Aktarma Kalan Üretim], isnull((case when (select sum(Quantity) - (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and BalloonFilmingWorkOrder in (select Oid from BalloonFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from BalloonFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) from BalloonFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and BalloonFilmingWorkOrder in (select Oid from BalloonFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from BalloonFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco5 CPP Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco5 Dilme Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastFilmingWorkOrder in (select Oid from CastFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and CastFilmingWorkOrder in (select Oid from CastFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from CastFilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco5 Çekim Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6WorkOrder in (select Oid from Eco6WorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6WorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6WorkOrder in (select Oid from Eco6WorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6WorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) from Eco6WorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco6 Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco6 Konfeksiyon Kalan Üretim], isnull((case when (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) >= 0 then (select sum(Quantity) - (select isnull(sum(GrossQuantity), 0) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid)) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid) else 0 end), 0) as [Eco6 Laminasyon Kalan Üretim], (case when (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0)) >= 0 then (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Baský')), 0)) else 0 end) as [Baský Depoya Girecek], (case when (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0)) >= 0 then (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and SlicingWorkOrder in (select Oid from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim'))) from SlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Kesim')), 0)) else 0 end) as [Kesim Depoya Girecek], (case when (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0)) >= 0 then (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6CuttingWorkOrder in (select Oid from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from Eco6CuttingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and LaminationWorkOrder in (select Oid from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Dilme')), 0)) else 0 end) as [Dilme Depoya Girecek], (case when (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0)) >= 0 then (isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and FilmingWorkOrder in (select Oid from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from FilmingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and CastSlicingWorkOrder in (select Oid from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from CastSlicingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and Eco6LaminationWorkOrder in (select Oid from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from Eco6LaminationWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0) + isnull((select sum(Quantity) - (select sum(GrossQuantity) from Production where GCRecord is null and PrintingWorkOrder in (select Oid from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon'))) from PrintingWorkOrder where GCRecord is null and SalesOrderDetail = D.Oid and NextStation = (select Oid from Station where Name = 'Laminasyon')), 0)) else 0 end) as [Laminasyon Depoya Girecek]

from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact left outer join City CT on CT.Oid = C.City left outer join [Route] R on R.Oid = CT.[Route] inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup left outer join MaterialType MT on MT.Oid = P.MaterialType left outer join MaterialColor MC on MC.Oid = P.MaterialColor left outer join Reciept R1 on R1.Oid = P.FilmCode1 left outer join Reciept R2 on R2.Oid = P.FilmCode2 inner join Unit U on U.Oid = D.Unit inner join Unit CU on CU.Oid = D.cUnit inner join SalesOffice SO on SO.Oid = O.SalesOffice inner join SalesGroup SG on SG.Oid = O.SalesGroup left outer join ContactGroup2 PZ on PZ.Oid = O.ContactGroup2 left outer join DistributionChannel DC on DC.Oid = O.DistributionChannel left outer join PaymentMethod PM on PM.Oid = O.PaymentMethod inner join Currency CR on CR.Oid = D.Currency 
where D.GCRecord is null and cast(O.OrderDate as date) between '2017-05-01' and '2017-05-02'