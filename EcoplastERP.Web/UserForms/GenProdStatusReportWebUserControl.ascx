<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="GenProdStatusReportWebUserControl.ascx.cs" Inherits="EcoplastERP.Web.UserForms.GenProdStatusReportWebUserControl" %>
<%@ Register Assembly="DevExpress.Web.v20.1, Version=20.1.7.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web" TagPrefix="dx" %>

<dx:ASPxGridView ID="gridView1" runat="server" Width="100%" DataSourceID="SqlDataSource1" AutoGenerateColumns="true" Settings-HorizontalScrollBarMode="Auto" Settings-ShowGroupPanel="true" Settings-ShowFooter="true"></dx:ASPxGridView>

<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:ConnectionString %>" SelectCommand="select PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], SUM(SD.cQuantity) as [Sipariş TÖB Miktarı], SUM(SD.ShippedcQuantity) as [Sevk Edilen TÖB Miktar], (case when (SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity)) > 0 then SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity) else 0 end) as [Bekleyen TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code like '8%') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Depo TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '710') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Baskı Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '740') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Konfeksiyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '743') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Dilme Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '712') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Laminasyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '750') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) as [Cast Depo], (case when ((case when (SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity)) > 0 then SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code like '8%') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '710') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '740') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '743') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '712') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '750') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0))) > 0 then ((case when (SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity)) > 0 then SUM(SD.cQuantity) - SUM(SD.ShippedcQuantity) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code like '8%') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '710') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '740') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '743') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '712') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and Code = '750') and Product in (select Oid from Product where GCRecord is null and ProductGroup = PG.Oid and ProductType = PT.Oid and ProductKind = PK.Oid)), 0))) else 0 end) as [Üretilecek TÖB Miktar] from SalesOrderDetail SD inner join SalesOrder O on O.Oid = SD.SalesOrder inner join Product P on P.Oid = SD.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where SD.GCRecord is null and SD.SalesOrderStatus < 200 and O.SalesOrderType != 1 group by PG.Oid, PG.Name, PT.Oid, PT.Name, PK.Oid, PK.Name, PKG.Name"></asp:SqlDataSource>

