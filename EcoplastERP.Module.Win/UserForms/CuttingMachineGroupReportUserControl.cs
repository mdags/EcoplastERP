using System.Data;
using System.Data.SqlClient;
using DevExpress.Utils;
using DevExpress.ExpressApp;
using DevExpress.XtraEditors;
using DevExpress.ExpressApp.Xpo;
using DevExpress.ExpressApp.Editors;
using EcoplastERP.Module.Win.Forms;

namespace EcoplastERP.Module.Win.UserForms
{
    public partial class CuttingMachineGroupReportUserControl : XtraUserControl, IComplexControl
    {
        private XafApplication application;
        public int reportID = 1;
        string sqlText = string.Empty, where = string.Empty;

        public CuttingMachineGroupReportUserControl()
        {
            InitializeComponent();
        }

        void IComplexControl.Setup(IObjectSpace objectSpace, XafApplication application)
        {
            this.application = application;
        }

        public void SelectReportType()
        {
            if (reportID == 1)
            {
                sqlText = @"select D.CuttingMachineGroup, isnull(C.Name, 'Z-GRUBU OLMAYANLAR') as [Kesim Makine Grubu], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) as [Bekleyen TÖB Miktar], (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) as [Sevk Depo TÖB Miktar], (case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) else 0 end) as [Üretilecek TÖB Miktar], isnull(C.Capacity, 0) as [Kapasite (gün)], (case when C.Capacity > 0 then (((case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup)) else 0 end)) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Toplam Dolu Gün], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) as [Geçmiş Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Geçmiş Gün Doluluk], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) as [Bu Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bu Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [Bir Sonraki Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bir Sonraki Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [İleri Termin Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [İleri Termin Doluluk], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup))) as [Sevk Edilen TÖB Miktar], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı')) as [Baskı Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [Kesim Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [Dilme Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [Laminasyon Depo] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder left outer join CuttingMachineGroup C on C.Oid = D.CuttingMachineGroup inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') group by D.CuttingMachineGroup, C.Name, C.Capacity order by [Kesim Makine Grubu]";
            }
            if (reportID == 2)
            {
                sqlText = @"select D.CuttingMachineGroup, isnull(C.Name, 'Z-GRUBU OLMAYANLAR') as [Kesim Makine Grubu], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4)))) as [Bekleyen TÖB Miktar], (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))) as [Sevk Depo TÖB Miktar], (case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4)) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))) else 0 end) as [Üretilecek TÖB Miktar], isnull(C.Capacity, 0) as [Kapasite (gün)], (case when C.Capacity > 0 then (((case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4))) else 0 end)) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Toplam Dolu Gün], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) as [Geçmiş Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Geçmiş Gün Doluluk], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) as [Bu Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bu Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [Bir Sonraki Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bir Sonraki Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [İleri Termin Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [İleri Termin Doluluk], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (0, 2, 3, 4)))) as [Sevk Edilen TÖB Miktar], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı')) as [Baskı Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [Kesim Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [Dilme Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [Laminasyon Depo] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder left outer join CuttingMachineGroup C on C.Oid = D.CuttingMachineGroup inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (0, 2, 3, 4) group by D.CuttingMachineGroup, C.Name, C.Capacity order by [Kesim Makine Grubu]";
            }
            if (reportID == 3)
            {
                sqlText = @"select D.CuttingMachineGroup, isnull(C.Name, 'Z-GRUBU OLMAYANLAR') as [Kesim Makine Grubu], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7)))) as [Bekleyen TÖB Miktar], (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))) as [Sevk Depo TÖB Miktar], (case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7)) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))) else 0 end) as [Üretilecek TÖB Miktar], isnull(C.Capacity, 0) as [Kapasite (gün)], (case when C.Capacity > 0 then (((case when ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))))) - (select sum(cQuantity) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1))) >= 0 then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))))) - (select sum(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7))) else 0 end)) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Toplam Dolu Gün], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) as [Geçmiş Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) < CAST(GETDATE() as date)) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Geçmiş Gün Doluluk], (case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) as [Bu Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) > 0 then (select (sum(cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))))) - (select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)))) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= cast(GETDATE() as date) and cast(D1.LineDeliveryDate as date) < (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bu Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [Bir Sonraki Ay Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) >= (select DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 1, 0)) and cast(D1.LineDeliveryDate as date) <= (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [Bir Sonraki Ay Doluluk], (case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) as [İleri Termin Üretilecek], (case when C.Capacity > 0 then ((case when (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(D1.LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) > 0 then (select (isnull(sum(cQuantity), 0) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))))))) - (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0))) )) from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7) and cast(LineDeliveryDate as date) > (select DATEADD (dd, -1, DATEADD(mm, DATEDIFF(mm, 0, GETDATE()) + 2, 0)))) else 0 end) / (case when C.Capacity <= 0 then 1 else C.Capacity end)) else 0 end) as [İleri Termin Doluluk], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder inner join Product P1 on P1.Oid = D1.Product inner join ProductGroup PG1 on PG1.Oid = P1.ProductGroup where D1.GCRecord is null and D1.SalesOrderStatus < 200 and (PG1.Code = 'OM' or PG1.Code = 'SM') and D1.CuttingMachineGroup = D.CuttingMachineGroup and O1.SalesOrderType in (1, 5, 6, 7)))) as [Sevk Edilen TÖB Miktar], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı')) as [Baskı Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim')) as [Kesim Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme')) as [Dilme Depo], (select isnull(SUM(cQuantity), 0) from Store where GCRecord is null and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup) and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon')) as [Laminasyon Depo] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder left outer join CuttingMachineGroup C on C.Oid = D.CuttingMachineGroup inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (1, 5, 6, 7) group by D.CuttingMachineGroup, C.Name, C.Capacity order by [Kesim Makine Grubu]";
            }
        }

        public void RefreshGrid()
        {
            IObjectSpace objectSpace = application.CreateObjectSpace();

            DataTable dt = new DataTable();
            gridControl1.DataSource = null;
            gridView1.Columns.Clear();
            where = string.Empty;

            SqlDataAdapter adapter = new SqlDataAdapter(sqlText + where, ((XPObjectSpace)objectSpace).Session.ConnectionString);
            adapter.Fill(dt);
            dt.Columns["CuttingMachineGroup"].ColumnMapping = MappingType.Hidden;
            gridControl1.DataSource = dt;
            gridControl1.ForceInitialize();
            gridView1.BestFitColumns();

            if (gridView1.Columns["Bekleyen TÖB Miktar"] != null)
            {
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bekleyen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Sevk Depo TÖB Miktar"] != null)
            {
                gridView1.Columns["Sevk Depo TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sevk Depo TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sevk Depo TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sevk Depo TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sevk Depo TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Üretilecek TÖB Miktar"] != null)
            {
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Üretilecek TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Kapasite (gün)"] != null)
            {
                gridView1.Columns["Kapasite (gün)"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Kapasite (gün)"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Kapasite (gün)"].Summary.Count == 0)
                    gridView1.Columns["Kapasite (gün)"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Kapasite (gün)", "{0:n2}");
            }
            if (gridView1.Columns["Toplam Dolu Gün"] != null)
            {
                gridView1.Columns["Toplam Dolu Gün"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Toplam Dolu Gün"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Toplam Dolu Gün"].Summary.Count == 0)
                    gridView1.Columns["Toplam Dolu Gün"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Toplam Dolu Gün", "{0:n2}");
            }
            if (gridView1.Columns["Geçmiş Üretilecek"] != null)
            {
                gridView1.Columns["Geçmiş Üretilecek"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Geçmiş Üretilecek"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Geçmiş Üretilecek"].Summary.Count == 0)
                    gridView1.Columns["Geçmiş Üretilecek"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Geçmiş Üretilecek", "{0:n2}");
            }
            if (gridView1.Columns["Geçmiş Gün Doluluk"] != null)
            {
                gridView1.Columns["Geçmiş Gün Doluluk"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Geçmiş Gün Doluluk"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Geçmiş Gün Doluluk"].Summary.Count == 0)
                    gridView1.Columns["Geçmiş Gün Doluluk"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Geçmiş Gün Doluluk", "{0:n2}");
            }
            if (gridView1.Columns["Bu Ay Üretilecek"] != null)
            {
                gridView1.Columns["Bu Ay Üretilecek"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bu Ay Üretilecek"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bu Ay Üretilecek"].Summary.Count == 0)
                    gridView1.Columns["Bu Ay Üretilecek"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bu Ay Üretilecek", "{0:n2}");
            }
            if (gridView1.Columns["Bu Ay Doluluk"] != null)
            {
                gridView1.Columns["Bu Ay Doluluk"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bu Ay Doluluk"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bu Ay Doluluk"].Summary.Count == 0)
                    gridView1.Columns["Bu Ay Doluluk"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bu Ay Doluluk", "{0:n2}");
            }
            if (gridView1.Columns["Bir Sonraki Ay Üretilecek"] != null)
            {
                gridView1.Columns["Bir Sonraki Ay Üretilecek"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bir Sonraki Ay Üretilecek"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bir Sonraki Ay Üretilecek"].Summary.Count == 0)
                    gridView1.Columns["Bir Sonraki Ay Üretilecek"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bir Sonraki Ay Üretilecek", "{0:n2}");
            }
            if (gridView1.Columns["Bir Sonraki Ay Doluluk"] != null)
            {
                gridView1.Columns["Bir Sonraki Ay Doluluk"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bir Sonraki Ay Doluluk"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bir Sonraki Ay Doluluk"].Summary.Count == 0)
                    gridView1.Columns["Bir Sonraki Ay Doluluk"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bir Sonraki Ay Doluluk", "{0:n2}");
            }
            if (gridView1.Columns["İleri Termin Üretilecek"] != null)
            {
                gridView1.Columns["İleri Termin Üretilecek"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["İleri Termin Üretilecek"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["İleri Termin Üretilecek"].Summary.Count == 0)
                    gridView1.Columns["İleri Termin Üretilecek"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "İleri Termin Üretilecek", "{0:n2}");
            }
            if (gridView1.Columns["İleri Termin Doluluk"] != null)
            {
                gridView1.Columns["İleri Termin Doluluk"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["İleri Termin Doluluk"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["İleri Termin Doluluk"].Summary.Count == 0)
                    gridView1.Columns["İleri Termin Doluluk"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "İleri Termin Doluluk", "{0:n2}");
            }
            if (gridView1.Columns["Sipariş TÖB Miktar"] != null)
            {
                gridView1.Columns["Sipariş TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sipariş TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sipariş TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sipariş TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sipariş TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Sevk Edilen TÖB Miktar"] != null)
            {
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sevk Edilen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Baskı Depo"] != null)
            {
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Baskı Depo"].Summary.Count == 0)
                    gridView1.Columns["Baskı Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Baskı Depo", "{0:n2}");
            }
            if (gridView1.Columns["Kesim Depo"] != null)
            {
                gridView1.Columns["Kesim Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Kesim Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Kesim Depo"].Summary.Count == 0)
                    gridView1.Columns["Kesim Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Kesim Depo", "{0:n2}");
            }
            if (gridView1.Columns["Dilme Depo"] != null)
            {
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Dilme Depo"].Summary.Count == 0)
                    gridView1.Columns["Dilme Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Dilme Depo", "{0:n2}");
            }
            if (gridView1.Columns["Laminasyon Depo"] != null)
            {
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Laminasyon Depo"].Summary.Count == 0)
                    gridView1.Columns["Laminasyon Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Laminasyon Depo", "{0:n2}");
            }
        }

        private void gridView1_DoubleClick(object sender, System.EventArgs e)
        {
            if (gridView1.FocusedValue == null) return;
            IObjectSpace objectSpace = application.CreateObjectSpace();
            CuttingMachineGroupReportDetailForm form = new CuttingMachineGroupReportDetailForm()
            {
                objectSpace = objectSpace,
                reportID = this.reportID,
                groupOid = gridView1.GetFocusedRowCellValue("CuttingMachineGroup").ToString()
            };
            form.ShowDialog();
        }
    }
}
