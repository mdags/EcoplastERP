using System;
using System.Data;
using System.Windows.Forms;
using System.Data.SqlClient;
using DevExpress.Utils;
using DevExpress.ExpressApp;
using DevExpress.ExpressApp.Xpo;

namespace EcoplastERP.Module.Win.Forms
{
    public partial class GenProdStatusReportDetailForm : Form
    {
        public IObjectSpace objectSpace;
        public int reportID = 1;
        public string productKindOid = string.Empty;

        public GenProdStatusReportDetailForm()
        {
            InitializeComponent();
        }

        private void GenProdStatusReportDetailForm_Load(object sender, EventArgs e)
        {
            DataTable dt = new DataTable();
            string sqlText = string.Empty;
            if (reportID == 1)
            {
                sqlText = string.Format(@"select D.Oid, P.Oid, PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], D.LineDeliveryDate as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) as [Sipariş TÖB Miktarı], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar], (case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) as [Bekleyen TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) as [Depo TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) as [Baskı Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) as [Konfeksiyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) as [Dilme Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) as [Laminasyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0) as [Cast Depo], (case when ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) > 0 then ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) else 0 end) as [Üretilecek TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and PK.Oid = '{0}' group by PG.Oid, PG.Name, PT.Oid, PT.Name, PK.Oid, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.LineNumber, D.LineDeliveryDate, D.Oid, P.Oid, C.Name, SC.Name, P.Code, P.Name", productKindOid);
            }
            if (reportID == 2)
            {
                sqlText = string.Format(@"select D.Oid, P.Oid, PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], D.LineDeliveryDate as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) as [Sipariş TÖB Miktarı], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar], (case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) as [Bekleyen TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) as [Depo TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) as [Baskı Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) as [Konfeksiyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) as [Dilme Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) as [Laminasyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0) as [Cast Depo], (case when ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) > 0 then ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) else 0 end) as [Üretilecek TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (0, 2, 3, 4) and PK.Oid = '{0}' group by PG.Oid, PG.Name, PT.Oid, PT.Name, PK.Oid, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.LineNumber, D.LineDeliveryDate, D.Oid, P.Oid, C.Name, SC.Name, P.Code, P.Name", productKindOid);
            }
            if (reportID == 3)
            {
                sqlText = string.Format(@"select D.Oid, P.Oid, PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], D.LineDeliveryDate as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) as [Sipariş TÖB Miktarı], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar], (case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) as [Bekleyen TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) as [Depo TÖB Miktar], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) as [Baskı Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) as [Konfeksiyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) as [Dilme Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) as [Laminasyon Depo], isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0) as [Cast Depo], (case when ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) > 0 then ((case when (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) > 0 then SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) else 0 end) - (isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Baskı') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Dilme') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Laminasyon') and SalesOrderDetail = D.Oid), 0) + isnull((select SUM(cQuantity) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Balonlu Çekim') and SalesOrderDetail = D.Oid), 0))) else 0 end) as [Üretilecek TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (1, 5, 6, 7) and PK.Oid = '{0}' group by PG.Oid, PG.Name, PT.Oid, PT.Name, PK.Oid, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.LineNumber, D.LineDeliveryDate, D.Oid, P.Oid, C.Name, SC.Name, P.Code, P.Name", productKindOid);
            }

            gridControl1.DataSource = null;
            gridView1.Columns.Clear();

            SqlDataAdapter adapter = new SqlDataAdapter(sqlText, ((XPObjectSpace)objectSpace).Session.ConnectionString);
            adapter.SelectCommand.CommandTimeout = 300;
            adapter.Fill(dt);
            gridControl1.DataSource = dt;
            gridControl1.ForceInitialize();
            gridView1.BestFitColumns();

            if (gridView1.Columns["Sipariş TÖB Miktarı"] != null)
            {
                gridView1.Columns["Sipariş TÖB Miktarı"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sipariş TÖB Miktarı"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sipariş TÖB Miktarı"].Summary.Count == 0)
                    gridView1.Columns["Sipariş TÖB Miktarı"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sipariş TÖB Miktarı", "{0:n2}");
            }
            if (gridView1.Columns["Sevk Edilen TÖB Miktar"] != null)
            {
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sevk Edilen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Bekleyen TÖB Miktar"] != null)
            {
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bekleyen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Depo TÖB Miktar"] != null)
            {
                gridView1.Columns["Depo TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Depo TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Depo TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Depo TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Depo TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Baskı Depo"] != null)
            {
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Baskı Depo"].Summary.Count == 0)
                    gridView1.Columns["Baskı Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Baskı Depo", "{0:n2}");
            }
            if (gridView1.Columns["Konfeksiyon Depo"] != null)
            {
                gridView1.Columns["Konfeksiyon Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Konfeksiyon Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Konfeksiyon Depo"].Summary.Count == 0)
                    gridView1.Columns["Konfeksiyon Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Konfeksiyon Depo", "{0:n2}");
            }
            if (gridView1.Columns["Dilme Depo"] != null)
            {
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Dilme Depo"].Summary.Count == 0)
                    gridView1.Columns["Dilme Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Dilme Depo", "{0:n2}");
            }
            if (gridView1.Columns["Laminasyon Depo"] != null)
            {
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Laminasyon Depo"].Summary.Count == 0)
                    gridView1.Columns["Laminasyon Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Laminasyon Depo", "{0:n2}");
            }
            if (gridView1.Columns["Cast Depo"] != null)
            {
                gridView1.Columns["Cast Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Cast Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Cast Depo"].Summary.Count == 0)
                    gridView1.Columns["Cast Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Cast Depo", "{0:n2}");
            }
            if (gridView1.Columns["Üretilecek TÖB Miktar"] != null)
            {
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Üretilecek TÖB Miktar", "{0:n2}");
            }
        }

        private void GenProdStatusReportDetailForm_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Escape) this.Close();
        }
    }
}
