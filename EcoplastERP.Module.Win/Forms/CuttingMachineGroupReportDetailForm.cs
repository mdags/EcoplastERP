using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;
using DevExpress.Utils;
using DevExpress.ExpressApp;
using DevExpress.XtraEditors;
using DevExpress.ExpressApp.Xpo;

namespace EcoplastERP.Module.Win.Forms
{
    public partial class CuttingMachineGroupReportDetailForm : XtraForm
    {
        public IObjectSpace objectSpace;
        public int reportID = 1;
        public string groupOid = string.Empty;

        public CuttingMachineGroupReportDetailForm()
        {
            InitializeComponent();
        }

        private void CuttingMachineGroupReportDetailForm_Load(object sender, EventArgs e)
        {
            DataTable dt = new DataTable();
            string sqlText = string.Empty;
            if (reportID == 1)
            {
                sqlText = string.Format(@"select CMG.Name as [Kesim Makine Grubu], PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], cast(D.LineDeliveryDate as date) as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Bekleyen TÖB Miktar], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select Oid from SalesOrderDetail where GCRecord is null and SalesOrderStatus < 200 and CuttingMachineGroup = D.CuttingMachineGroup and Product = P.Oid)) end) as [Sevk Depo TÖB Miktar], (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Depo Karşılama], (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Üretilecek TÖB Miktar], CMG.Capacity as [Kapasite (gün)], (case when CMG.Capacity > 0 then ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and Product = P.Oid) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end)) / CMG.Capacity else 0 end) as [Toplam Dolu Gün], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and Product = P.Oid) end) as [Kesim Depo], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join CuttingMachineGroup CMG on CMG.Oid = D.CuttingMachineGroup inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and D.CuttingMachineGroup = '{0}' group by D.CuttingMachineGroup, CMG.Name, CMG.Capacity, PG.Code, PG.Name, PT.Name, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.Oid, D.LineNumber, D.LineDeliveryDate, C.Name, SC.Name, P.Oid, P.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate", groupOid);
            }
            if (reportID == 2)
            {
                sqlText = string.Format(@"select CMG.Name as [Kesim Makine Grubu], PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], cast(D.LineDeliveryDate as date) as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Bekleyen TÖB Miktar], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) as [Sevk Depo TÖB Miktar], (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Depo Karşılama], (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Üretilecek TÖB Miktar], CMG.Capacity as [Kapasite (gün)], (case when CMG.Capacity > 0 then ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (0, 2, 3, 4) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end)) / CMG.Capacity else 0 end) as [Toplam Dolu Gün], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and Product = P.Oid) end) as [Kesim Depo], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join CuttingMachineGroup CMG on CMG.Oid = D.CuttingMachineGroup inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (0, 2, 3, 4) and D.CuttingMachineGroup = '{0}' group by D.CuttingMachineGroup, CMG.Name, CMG.Capacity, PG.Code, PG.Name, PT.Name, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.Oid, D.LineNumber, D.LineDeliveryDate, C.Name, SC.Name, P.Oid, P.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate", groupOid);
            }
            if (reportID == 3)
            {
                sqlText = string.Format(@"select CMG.Name as [Kesim Makine Grubu], PG.Name as [Ürün Grubu], PT.Name as [Ürün Tipi], PK.Name as [Ürün Cinsi], PKG.Name as [Satış Ürün Grubu], (case when P.PrintStatus = 0 then 'Baskılı' else 'Baskısız' end) as [Baskı Durumu], O.OrderNumber+'/'+cast(D.LineNumber as varchar(5)) as [Sipariş No], cast(D.LineDeliveryDate as date) as [Termin Tarihi], C.Name as [Siparişi Veren], SC.Name as [Malı Teslim Alan], P.Code as [Malzeme Kodu], P.Name as [Malzeme Adı], SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Bekleyen TÖB Miktar], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) as [Sevk Depo TÖB Miktar], (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Depo Karşılama], (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end) as [Üretilecek TÖB Miktar], CMG.Capacity as [Kapasite (gün)], (case when CMG.Capacity > 0 then ((SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) - (case when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < 0 then 0 when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) > (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) when ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) < (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) then ((case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse in (select Oid from Warehouse where GCRecord is null and ShippingWarehouse = 1) and SalesOrderDetail in (select D1.Oid from SalesOrderDetail D1 inner join SalesOrder O1 on O1.Oid = D1.SalesOrder where D1.GCRecord is null and D1.SalesOrderStatus < 200 and O1.SalesOrderType in (1, 5, 6, 7) and D1.CuttingMachineGroup = D.CuttingMachineGroup and D1.Product = P.Oid)) end) - ((sum(SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))) over (partition by PG.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate rows unbounded preceding)) - (SUM(D.cQuantity) - (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid))))) end)) / CMG.Capacity else 0 end) as [Toplam Dolu Gün], (case when PG.Code = 'OM' then (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and SalesOrderDetail = D.Oid) else (select isnull(sum(cQuantity), 0) from Store where GCRecord is null and Warehouse = (select SourceWarehouse from Station where GCRecord is null and Name = 'Kesim') and Product = P.Oid) end) as [Kesim Depo], sum(D.cQuantity) as [Sipariş TÖB Miktar], (select isnull(sum(cQuantity), 0) from DeliveryDetailLoading where GCRecord is null and DeliveryDetail in (select Oid from DeliveryDetail where GCRecord is null and SalesOrderDetail = D.Oid)) as [Sevk Edilen TÖB Miktar] from SalesOrderDetail D inner join SalesOrder O on O.Oid = D.SalesOrder inner join Contact C on C.Oid = O.Contact inner join Contact SC on SC.Oid = O.ShippingContact inner join Product P on P.Oid = D.Product inner join ProductGroup PG on PG.Oid = P.ProductGroup inner join ProductType PT on PT.Oid = P.ProductType inner join ProductKind PK on PK.Oid = P.ProductKind inner join CuttingMachineGroup CMG on CMG.Oid = D.CuttingMachineGroup inner join ProductKindGroup PKG on PKG.Oid = PK.ProductKindGroup where D.GCRecord is null and D.SalesOrderStatus < 200 and (PG.Code = 'OM' or PG.Code = 'SM') and O.SalesOrderType in (1, 5, 6, 7) and D.CuttingMachineGroup = '{0}' group by D.CuttingMachineGroup, CMG.Name, CMG.Capacity, PG.Code, PG.Name, PT.Name, PK.Name, PKG.Name, P.PrintStatus, O.OrderNumber, D.Oid, D.LineNumber, D.LineDeliveryDate, C.Name, SC.Name, P.Oid, P.Code, P.Name order by PG.Name, P.Name, D.LineDeliveryDate", groupOid);
            }

            gridControl1.DataSource = null;
            gridView1.Columns.Clear();

            SqlDataAdapter adapter = new SqlDataAdapter(sqlText, ((XPObjectSpace)objectSpace).Session.ConnectionString);
            adapter.SelectCommand.CommandTimeout = 300;
            adapter.Fill(dt);
            gridControl1.DataSource = dt;
            gridControl1.ForceInitialize();
            gridView1.BestFitColumns();

            if (gridView1.Columns["Bekleyen TÖB Miktar"] != null)
            {
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Bekleyen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Bekleyen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Bekleyen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Sevk Depo TÖB Miktar"] != null)
            {
                gridView1.Columns["Sevk Depo TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sevk Depo TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sevk Depo TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sevk Depo TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sevk Depo TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Üretilecek TÖB Miktar"] != null)
            {
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Üretilecek TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Üretilecek TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Üretilecek TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Toplam Dolu Gün"] != null)
            {
                gridView1.Columns["Toplam Dolu Gün"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Toplam Dolu Gün"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Toplam Dolu Gün"].Summary.Count == 0)
                    gridView1.Columns["Toplam Dolu Gün"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Toplam Dolu Gün", "{0:n2}");
            }
            if (gridView1.Columns["Sipariş TÖB Miktar"] != null)
            {
                gridView1.Columns["Sipariş TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sipariş TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sipariş TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sipariş TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sipariş TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Sevk Edilen TÖB Miktar"] != null)
            {
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Sevk Edilen TÖB Miktar"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Count == 0)
                    gridView1.Columns["Sevk Edilen TÖB Miktar"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Sevk Edilen TÖB Miktar", "{0:n2}");
            }
            if (gridView1.Columns["Baskı Depo"] != null)
            {
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Baskı Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Baskı Depo"].Summary.Count == 0)
                    gridView1.Columns["Baskı Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Baskı Depo", "{0:n2}");
            }
            if (gridView1.Columns["Kesim Depo"] != null)
            {
                gridView1.Columns["Kesim Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Kesim Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Kesim Depo"].Summary.Count == 0)
                    gridView1.Columns["Kesim Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Kesim Depo", "{0:n2}");
            }
            if (gridView1.Columns["Dilme Depo"] != null)
            {
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Dilme Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Dilme Depo"].Summary.Count == 0)
                    gridView1.Columns["Dilme Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Dilme Depo", "{0:n2}");
            }
            if (gridView1.Columns["Laminasyon Depo"] != null)
            {
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatType = FormatType.Numeric;
                gridView1.Columns["Laminasyon Depo"].DisplayFormat.FormatString = "n2";
                if (gridView1.Columns["Laminasyon Depo"].Summary.Count == 0)
                    gridView1.Columns["Laminasyon Depo"].Summary.Add(DevExpress.Data.SummaryItemType.Sum, "Laminasyon Depo", "{0:n2}");
            }
        }

        private void CuttingMachineGroupReportDetailForm_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Escape) this.Close();
        }
    }
}
